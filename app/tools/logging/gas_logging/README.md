# 气测录井工具模块

本模块提供专业的气测录井数据分析和解释功能，用于油气勘探开发中的录井解释工作。

## 工具列表

### 1. 三角图版法解释含油气性质工具 (triangular_chart_analysis)

基于Q值计算进行含油气性质判别的专业工具。

#### 功能描述
- 计算Q值：Q = 1 - (C2 + C3 + nC4) / (0.2 × ∑C)
- 根据Q值范围自动评价含油气性质
- 智能文件管理：在原文件基础上追加分析列
- 生成可视化图表（Q值深度剖面图、含油气性质分布饼图）

#### 评价标准
| Q值范围 | 内三角形形状 | 含油气性质 |
|---------|-------------|-----------|
| 75%～100% | 大正三角形 | 水或气层 |
| 25%～75% | 中正三角形 | 油气层或含油水层 |
| 0%～25% | 小正三角形 | 油气转化带 |
| -25%～0% | 小倒三角形 | 油气转化带 |
| -25%～-75% | 中倒三角形 | 油层（高气油比） |
| -75%～-100% | 大倒三角形 | 油层（高气油比） |

### 2. TG油气水层评价工具 (tg_layer_evaluation)

基于全烃含量（TG）进行油气水层综合评价的专业工具。

#### 功能描述
- 计算TG背景值和异常倍数
- 分析TG随深度的变化趋势
- 进行层型分类和连续性校正
- 生成四联图可视化分析

#### 评价标准（完善后）
| 层型 | TG绝对值 | 相对异常倍数 | 趋势特征 | 连续性要求 |
|------|----------|-------------|----------|-----------|
| 水层 | < 2% | < 2倍背景值 | 平稳，无明显变化 | - |
| 弱显示层 | 2-5% | 2-3倍背景值 | 轻微上升 | ≥ 0.5m |
| 油层 | 5-15% | 3-8倍背景值 | 持续上升或稳定高值 | ≥ 1.0m |
| 气层 | 15-30% | 8-20倍背景值 | 快速上升，峰值明显 | ≥ 0.5m |
| 强气层 | > 30% | > 20倍背景值 | 急剧上升，极高峰值 | ≥ 0.5m |

## 通用输入要求

Excel文件格式要求：
- **表头结构**: 第一行中文，第二行英文（保持原始格式）
- **必需列**: Well（井名）、Depth（井深）
- **工具特定列**: 根据具体工具要求

## 通用输出结果

1. **智能文件管理**:
   - 原始文件 → 生成新的"_interpreted.xlsx"文件
   - 已解释文件 → 在原文件基础上更新，保持文件名不变
   - 保持原始表头格式（两行中英文对照）

2. **可视化图表**: PNG格式，包含多种专业图表
3. **简洁执行报告**: 关键结果和文件信息

### 3. 3H比值法解释气层油层干层工具 (three_h_ratio_analysis)

基于湿度比(WH)、平衡比(BH)、特征比(CH)进行地层含油气水情况综合判断的专业工具。

#### 功能描述
- 计算3H比值：湿度比WH、平衡比BH、特征比CH
- 根据比值组合自动判断地层性质
- 生成置信度评价
- 智能文件管理：在原文件基础上追加分析列
- 生成可视化图表（WH深度剖面、BH深度剖面、解释结果饼图、CH-WH散点图）

#### 计算公式
- **湿度比**: WH = (C2+C3+C4+C5)/(C1+C2+C3+C4+C5) × 100%
- **平衡比**: BH = (C1+C2)/(C3+C4+C5)
- **特征比**: CH = (C4+C5)/C3

#### 解释规则
| 湿度比WH(%) | 平衡比BH | 特征比CH | 解释结果 | 备注 |
|-------------|----------|----------|----------|------|
| <0.5 | >100 | - | 干层 | - |
| 0.5-12.5 | - | <0.6 | 可采气 | 随WH增加：干气→湿气→凝析气 |
| 12.5-40 | - | ≥0.6 | 可采油 | 30-40%为轻质油 |
| >40 | - | - | 干层 | - |

## 待实现工具

### 4. 气体比值法评价油气水层工具  
- 计算气体比值参数
- 评价油气水层类型
- 生成综合评价报告

## 技术特点

1. **专业算法**: 基于成熟的录井解释理论和标准
2. **自动化处理**: 批量处理大量样品数据
3. **可视化输出**: 生成专业的图表和报告
4. **流式反馈**: 实时显示处理进度和结果
5. **多格式支持**: 支持Excel等常用数据格式

## 注意事项

1. 输入数据格式需严格按照要求准备
2. 计算结果仅供参考，需结合其他地质资料综合分析
3. 工具适用于常规气测录井数据分析
4. 异常值会在结果中标识，需要人工判断 